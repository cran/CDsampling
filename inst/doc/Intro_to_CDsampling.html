<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Y.H." />


<title>Introduction to CDsampling</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to CDsampling</h1>
<h4 class="author">Y.H.</h4>



<style type="text/css">
.note-box {
border: 1px solid #ccc;
background: white;
padding: 10px;
margin: 10px 0;
border-radius: 5px;
}
</style>
<div id="table-of-contents" class="section level1">
<h1>Table of Contents</h1>
<ul>
<li><a href="#Computation_Fisher">Computation of Fisher information
matrix</a>
<ul>
<li><a href="#example1_GLM_Fisher">Example 1: GLM Fisher information
matrix</a></li>
<li><a href="#example2_MLM_Fisher">Example 2: MLM Fisher information
matrix</a></li>
</ul></li>
<li><a href="#Applications">Applications in paid research studies</a>
<ul>
<li><a href="#example3_trial_data">Example 3: trial_data &amp;
constrained sampling with GLM</a></li>
<li><a href="#example4_trauma_data">Example 4: trauma_data &amp;
constrained sampling with MLM</a></li>
</ul></li>
<li><a href="#References">References</a></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(CDsampling)</span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>In the context of paid research studies and clinical trials, budget
considerations and patient sampling from available populations are
subject to inherent constraints. <strong>CDsampling</strong> integrates
optimal design theories within the framework of constrained
sampling.</p>
<ul>
<li><p>This package offers the possibility to find both D-optimal
approximate and exact allocations for sampling with or without
constraints.</p></li>
<li><p>Additionally, it provides functions to find constrained uniform
sampling as a robust sampling strategy with limited model
information.</p></li>
<li><p>It also provides tool for computation of Fisher information
matrix of the generalized linear models (GLMs) including regular linear
regression model and the multinomial logistic models (MLMs).</p></li>
<li><p>Two datasets are embedded in the package for application
examples.</p></li>
</ul>
<p><a id="Computation_Fisher"></a></p>
</div>
<div id="computation-of-fisher-information-matrix" class="section level1">
<h1>Computation of Fisher information matrix</h1>
<p><a id="example1_GLM_Fisher"></a></p>
<div id="example-1-glm-fisher-information-matrix" class="section level2">
<h2>Example 1: GLM Fisher information matrix</h2>
<p>Consider a research study with a simple logistic regression model
<span class="math display">\[\log(\frac{\mu_i}{1-\mu_i}) = \beta_0 +
\beta_1 x_{i1} + \beta_2 x_{i2}\]</span> where <span class="math inline">\(\mu_i = E(Y_i\mid {\mathbf x}_i)\)</span>, <span class="math inline">\({\mathbf x}_i = (x_{i1}, x_{i2})^\top \in \{(-1,
-1), (-1, +1), (+1, -1)\}\)</span> and parameters <span class="math inline">\(\boldsymbol \beta = (\beta_0, \beta_1, \beta_2) =
(0.5, 0.5, 0.5)\)</span>. In this example, we have <span class="math inline">\(m=3\)</span> design points <span class="math inline">\((x_{i1}, x_{i2})^\top \in \{(-1, -1), (-1, +1),
(+1, -1)\}\)</span>, the design matrix <span class="math inline">\(\mathbf X\)</span> (with the first column for the
intercept): <span class="math display">\[\begin{bmatrix}
1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; 1 \\
1 &amp; 1 &amp; -1\\
\end{bmatrix}\]</span>.</p>
<p>To calculate Fisher information matrix of the design with GLM, we can
use <em>F_func_GLM( )</em> in the package with input of approximate
allocation <span class="math inline">\(w\)</span>, coefficients <span class="math inline">\(\boldsymbol \beta\)</span>, and design matrix
<span class="math inline">\(\mathbf X\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="co">#coefficients</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>), <span class="at">byrow=</span><span class="cn">TRUE</span>, <span class="at">nrow=</span><span class="dv">3</span>) <span class="co">#design matrix</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>w <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="co">#approximate allocation</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>CDsampling<span class="sc">::</span><span class="fu">F_func_GLM</span>(<span class="at">w=</span>w, <span class="at">beta=</span>beta, <span class="at">X=</span>X, <span class="at">link=</span><span class="st">&#39;logit&#39;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; Dimensions: 3 x 3 </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; Matrix:</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; ------------------------------ </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;      [,1]        [,2]        [,3]       </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; [1,]  0.23500371 -0.07833457 -0.07833457</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; [2,] -0.07833457  0.23500371 -0.07833457</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; [3,] -0.07833457 -0.07833457  0.23500371</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; ------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p><a id="example2_MLM_Fisher"></a></p>
</div>
<div id="example-2-mlm-fisher-information-matrix" class="section level2">
<h2>Example 2: MLM Fisher information matrix</h2>
<p>Consider a research study with cumulative non-proportional odds
multinomial logit model with <span class="math inline">\(J=5\)</span>
response levels and covariates <span class="math inline">\((x_{i1},
x_{i2})=\{(1,0),(2,0),(3,0), (4,0),(1,1),(2,1),(3,1),(4,1)\}\)</span>.
The model can be written as:<span class="math display">\[\log(\frac{\pi_{i1}}{\pi_{i2}+\dots+\pi_{i5}}) =
\beta_{11}+\beta_{12}x_{i1}+\beta_{13}x_{i2}\]</span> <span class="math display">\[\log(\frac{\pi_{i1}+\pi_{i2}}{\pi_{i3}+\pi_{i4}+\pi_{i5}})
= \beta_{21}+\beta_{22}x_{i1}+\beta_{23}x_{i2}\]</span> <span class="math display">\[\log(\frac{\pi_{i1}+\pi_{i2}+\pi_{i3}}{\pi_{i4}+\pi_{i5}})
= \beta_{31}+\beta_{32}x_{i1}+\beta_{33}x_{i2}\]</span> <span class="math display">\[\log(\frac{\pi_{i1}+\dots+\pi_{i4}}{\pi_{i5}}) =
\beta_{41}+\beta_{42}x_{i1}+\beta_{43}x_{i2}\]</span> where <span class="math inline">\(i=1,\dots,8\)</span>. We have <span class="math inline">\(m=8\)</span> design points and <span class="math inline">\(p=12\)</span> parameters. We assume the parameters
<span class="math inline">\(\boldsymbol \beta = (\beta_{11}, \beta_{12},
\beta_{13}, \beta_{21}, \beta_{22}, \beta_{23}, \beta_{31}, \beta_{32},
\beta_{33}, \beta_{41}, \beta_{42}, \beta_{43})^\top = (-4.047, -0.131,
4.214, -2.225, -0.376,\)</span> <span class="math inline">\(3.519,
-0.302, -0.237, 2.420, 1.386, -0.120, 1.284)^\top\)</span>. The
approximate allocation for the eight design points is <span class="math inline">\(\mathbf w = (1/8, 1/8, 1/8, 1/8, 1/8, 1/8, 1/8,
1/8)^\top\)</span>.</p>
<p>To calculate the Fisher information matrix with MLM, we can use the
<em>F_func_MLM( )</em> with input of approximate allocation <span class="math inline">\(w\)</span>, covariate coefficients <span class="math inline">\(\boldsymbol \beta\)</span>, design matrix <span class="math inline">\(\mathbf X\)</span>, and multinomial logit model
(cumulative for this example).</p>
<p>The design matrix incorporates all <span class="math inline">\(8\)</span> design points of covariates <span class="math inline">\((x_{i1}, x_{i2})\)</span> specified by the
cumulative logit model’s four equations. For example, when <span class="math inline">\(x_{i1}=1\)</span>, <span class="math inline">\(x_{i2}=0\)</span>, the design matrix takes the
following format:</p>
<p><span class="math display">\[\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;
0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp;
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;
1 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;
0 &amp; 0 &amp; 0 \\
\end{bmatrix}\]</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>J<span class="ot">=</span><span class="dv">5</span>; p<span class="ot">=</span><span class="dv">12</span>; m<span class="ot">=</span><span class="dv">8</span>; <span class="co">#response levels; num of parameters; num of design points</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.047</span>, <span class="sc">-</span><span class="fl">0.131</span>, <span class="fl">4.214</span>, <span class="sc">-</span><span class="fl">2.225</span>, <span class="sc">-</span><span class="fl">0.376</span>, <span class="fl">3.519</span>, <span class="sc">-</span><span class="fl">0.302</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.237</span>,  <span class="fl">2.420</span>, <span class="fl">1.386</span>,  <span class="sc">-</span><span class="fl">0.120</span>,  <span class="fl">1.284</span>) </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>Xi<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,J<span class="sc">*</span>p<span class="sc">*</span>m) <span class="co">#design matrix   </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">dim</span>(Xi)<span class="ot">=</span><span class="fu">c</span>(J,p,m)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>Xi[,,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>Xi[,,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>Xi[,,<span class="dv">3</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>),</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a> Xi[,,<span class="dv">4</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>),</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a> Xi[,,<span class="dv">5</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a> Xi[,,<span class="dv">6</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a> Xi[,,<span class="dv">7</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a> Xi[,,<span class="dv">8</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a> alloc <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>,m) <span class="co">#approximate allocation</span></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a> CDsampling<span class="sc">::</span><span class="fu">F_func_MLM</span>(<span class="at">w=</span>alloc, <span class="at">beta=</span>beta, <span class="at">X=</span>Xi, <span class="at">link=</span><span class="st">&#39;cumulative&#39;</span>)</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="co">#&gt; Dimensions: 12 x 12 </span></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="co">#&gt; Matrix:</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------------------------------------------------------------------ </span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="co">#&gt;       [,1]        [,2]        [,3]        [,4]        [,5]        [,6]       </span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.44505694  1.37915564  0.43609135 -0.37247296 -1.21252053 -0.36379349</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a><span class="co">#&gt;  [2,]  1.37915564  4.78410934  1.35694145 -1.21252053 -4.31436344 -1.19085831</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="co">#&gt;  [3,]  0.43609135  1.35694145  0.43609135 -0.36379349 -1.19085831 -0.36379349</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="co">#&gt;  [4,] -0.37247296 -1.21252053 -0.36379349  0.51192600  1.55177413  0.48018678</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a><span class="co">#&gt;  [5,] -1.21252053 -4.31436344 -1.19085831  1.55177413  5.31193908  1.48241981</span></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a><span class="co">#&gt;  [6,] -0.36379349 -1.19085831 -0.36379349  0.48018678  1.48241981  0.48018678</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.00000000  0.00000000  0.00000000 -0.09154268 -0.22027625 -0.07471168</span></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.00000000  0.00000000  0.00000000 -0.22027625 -0.64323991 -0.18445802</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.00000000  0.00000000  0.00000000 -0.07471168 -0.18445802 -0.07471168</span></span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a><span class="co">#&gt; [10,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a><span class="co">#&gt; [11,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a><span class="co">#&gt; [12,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a><span class="co">#&gt;       [,7]        [,8]        [,9]        [,10]       [,11]       [,12]      </span></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a><span class="co">#&gt;  [3,]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a><span class="co">#&gt;  [4,] -0.09154268 -0.22027625 -0.07471168  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a><span class="co">#&gt;  [5,] -0.22027625 -0.64323991 -0.18445802  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a><span class="co">#&gt;  [6,] -0.07471168 -0.18445802 -0.07471168  0.00000000  0.00000000  0.00000000</span></span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.29320484  0.71978889  0.16205254 -0.10435894 -0.25399393 -0.06194131</span></span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.71978889  2.13312603  0.41294396 -0.25399393 -0.74842743 -0.15305771</span></span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.16205254  0.41294396  0.16205254 -0.06194131 -0.15305771 -0.06194131</span></span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a><span class="co">#&gt; [10,] -0.10435894 -0.25399393 -0.06194131  0.17861575  0.45287619  0.06925715</span></span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a><span class="co">#&gt; [11,] -0.25399393 -0.74842743 -0.15305771  0.45287619  1.37180187  0.17395849</span></span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a><span class="co">#&gt; [12,] -0.06194131 -0.15305771 -0.06194131  0.06925715  0.17395849  0.06925715</span></span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------------------------------------------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p><a id="Applications"></a></p>
</div>
</div>
<div id="applications-in-paid-research-studies" class="section level1">
<h1>Applications in paid research studies</h1>
<p><strong>CDsampling</strong> package addresses constrained sampling
problems in paid research studies or clinical trials where the number of
qualified volunteers exceeds the available budget. The CDsampling
package implements the designer’s sampling strategy and utilizes the
constrained lift-one algorithm to find the optimal sample sizes for
different subgroups with the goal to achieve the most accurate model
estimates.</p>
<p><a id="example3_trial_data"></a></p>
<div id="example-3-trial_data-constrained-sampling-with-glm" class="section level2">
<h2>Example 3: trial_data &amp; constrained sampling with GLM</h2>
<p>The <em>trial_data</em> is a simulated dataset containing information
for <span class="math inline">\(N=500\)</span> volunteers with gender,
age, and final efficacy information. The covariates considered in this
example are:</p>
<p>1). <strong>Gender:</strong></p>
<ul>
<li><p><span class="math inline">\(0\)</span>: for female</p></li>
<li><p><span class="math inline">\(1\)</span> for male</p></li>
</ul>
<p>2). <strong>Age group:</strong></p>
<ul>
<li><p><span class="math inline">\(age\_1 = 0\)</span> and <span class="math inline">\(age\_2 = 0\)</span>: ages <span class="math inline">\(18\sim25\)</span></p></li>
<li><p><span class="math inline">\(age\_1 = 1\)</span> and <span class="math inline">\(age\_2 = 0\)</span>: ages <span class="math inline">\(26\sim64\)</span></p></li>
<li><p><span class="math inline">\(age\_1 = 0\)</span> and <span class="math inline">\(age\_2 = 1\)</span>: ages <span class="math inline">\(65\)</span> and above.</p></li>
</ul>
<p>There are <span class="math inline">\(m=6\)</span> design points,
that is, the number of combinations of gender and age groups <span class="math inline">\((x_{gender\_i}, x_{age\_1i},
x_{age\_2i})\)</span>:</p>
<p>1). <span class="math inline">\((0,0,0)\)</span>: Female, 18-25 <span class="math inline">\(N_1=50\)</span>)</p>
<p>2). <span class="math inline">\((0,1,0)\)</span>: Female, 26-64
(<span class="math inline">\(N_2=40\)</span>)</p>
<p>3). <span class="math inline">\((0,0,1)\)</span>: Female, 65+ (<span class="math inline">\(N_3=10\)</span>)</p>
<p>4). <span class="math inline">\((1,0,0)\)</span>: Male, 18-25 (<span class="math inline">\(N_4=200\)</span>)</p>
<p>5). <span class="math inline">\((1,1,0)\)</span>: Male, 26-64 (<span class="math inline">\(N_5=150\)</span>)</p>
<p>6). <span class="math inline">\((1,0,1)\)</span>: Male, 65+ (<span class="math inline">\(N_6=50\)</span>)</p>
<p>Suppose that a sample of <span class="math inline">\(n=200\)</span>
participants is required due to budget limit.Our goal is to find the
constrained D-optimal allocation <span class="math inline">\((w_1, w_2,
\dots, w_6)\)</span> with feasible allocation <span class="math display">\[S = \{(w_1, \ldots, w_m)^T \in S_0 \mid n w_i
\leq N_i, i=1, \ldots, m\}.\]</span></p>
<p>We use constrained lift-one algorithm <em>liftone_constrained_GLM(
)</em> to find the locally D-optimal approximate sampling allocations
with the input of design matrix <span class="math inline">\(X\)</span>,
<span class="math inline">\(\mathbf W\)</span> matrix which is the
result returned from <em>W_func_GLM( )</em>, constraints setup (g.con,
g.dir, and g.rhs), and boundaries in searching for lift-one weight (step
3 in the constrained lift-one algorithm, see reference).</p>
<p>We consider the logistic regression model for <span class="math inline">\(j=1,\dots,m\)</span>, <span class="math inline">\(i=1,\dots,n_j\)</span> with <span class="math inline">\(\boldsymbol \beta=(\beta_{1}, \beta_{21},
\beta_{22})= (0,3,3,3)\)</span>:</p>
<p><span class="math display">\[\begin{equation}\label{eq:trial_logistic_model}
{\rm logit} \{P(Y_{ij}=1 \mid x_{gender\_i}, x_{age\_1i}, x_{age\_2i})\}
= \beta_0 + \beta_1 x_{gender\_i} + \beta_{21} x_{age\_1i} + \beta_{22}
x_{age\_2i}
\end{equation}\]</span></p>
<p>Use the following R codes to define the coefficients, sample size,
and design matrix:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>) <span class="co">#coefficients </span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#design matrix X</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>) </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>nsample<span class="ot">=</span><span class="dv">200</span> <span class="co">#sample size</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>To run the <em>liftone_constrained_GLM( )</em> function, we also need
to the <span class="math inline">\(\mathbf W\)</span> matrix from the
calculation of Fisher information matrix, we can use the <em>W_func_GLM(
)</em> function in the package:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>W_matrix<span class="ot">=</span>CDsampling<span class="sc">::</span><span class="fu">W_func_GLM</span>(<span class="at">X=</span>X, <span class="at">b=</span>beta, <span class="at">link=</span><span class="st">&quot;logit&quot;</span>) <span class="co">#W matrix</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>Lastly, we also need to define the constraints (number of patients
from different gender and age group) and boundaries for constrained
sampling (please see the reference for details of lower bound <span class="math inline">\(r_{i1}\)</span> and upper bound <span class="math inline">\(r_{i2}\)</span>):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>rc <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">50</span>)<span class="sc">/</span>nsample <span class="co">#constraints for each subgroup</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>g.con <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>(<span class="dv">2</span><span class="sc">*</span>m<span class="sc">+</span><span class="dv">1</span>), <span class="at">ncol=</span>m)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>g.con[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, m)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>g.con[<span class="dv">2</span><span class="sc">:</span>(m<span class="sc">+</span><span class="dv">1</span>),] <span class="ot">=</span> <span class="fu">diag</span>(m)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>g.con[(m<span class="sc">+</span><span class="dv">2</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>m<span class="sc">+</span><span class="dv">1</span>), ] <span class="ot">=</span> <span class="fu">diag</span>(m)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>g.dir <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;==&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&lt;=&quot;</span>, m), <span class="fu">rep</span>(<span class="st">&quot;&gt;=&quot;</span>, m))</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>g.rhs <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, rc, <span class="fu">rep</span>(<span class="dv">0</span>, m))</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>lower.bound<span class="ot">=</span><span class="cf">function</span>(i, w){</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  nsample <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  rc <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">50</span>)<span class="sc">/</span>nsample</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">length</span>(w) <span class="co">#num of categories</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  temp <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  temp[w<span class="sc">&gt;</span><span class="dv">0</span>]<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pmin</span>(<span class="dv">1</span>,rc[w<span class="sc">&gt;</span><span class="dv">0</span>])<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w[i])<span class="sc">/</span>w[w<span class="sc">&gt;</span><span class="dv">0</span>];</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  temp[i]<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  <span class="fu">max</span>(<span class="dv">0</span>,temp);</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>}</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>upper.bound<span class="ot">=</span><span class="cf">function</span>(i, w){</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  nsample <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  rc <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">50</span>)<span class="sc">/</span>nsample</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">length</span>(w) <span class="co">#num of categories</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  rc[i];</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="fu">min</span>(<span class="dv">1</span>,rc[i])</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>}</span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>We can define an optional subgroups label for the constrained
approximate allocations:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>label <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;F, 18-25&quot;</span>, <span class="st">&quot;F, 26-64&quot;</span>, <span class="st">&quot;F, &gt;=65&quot;</span>, <span class="st">&quot;M, 18-25&quot;</span>, <span class="st">&quot;M, 26-64&quot;</span>, <span class="st">&quot;M, &gt;=65&quot;</span>)</span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>Now, we can run the constrained lift-one algorithm to find optimal
approximate allocations for the defined subgroups:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>approximate_design <span class="ot">=</span> CDsampling<span class="sc">::</span><span class="fu">liftone_constrained_GLM</span>(<span class="at">X=</span>X, <span class="at">W=</span>W_matrix, <span class="at">g.con=</span>g.con, <span class="at">g.dir=</span>g.dir, </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                                               <span class="at">g.rhs=</span>g.rhs, <span class="at">lower.bound=</span>lower.bound, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                                               <span class="at">upper.bound=</span>upper.bound, <span class="at">label=</span>label, <span class="at">reltol=</span><span class="fl">1e-10</span>, </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                                               <span class="at">maxit=</span><span class="dv">100</span>, <span class="at">random=</span><span class="cn">TRUE</span>, <span class="at">nram=</span><span class="dv">4</span>, <span class="at">w00=</span><span class="cn">NULL</span>, </span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                                               <span class="at">epsilon=</span><span class="fl">1e-8</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="fu">print</span>(approximate_design)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Optimal Sampling Results:</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Optimal approximate allocation:</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;    F, 18-25 F, 26-64 F, &gt;=65 M, 18-25 M, 26-64 M, &gt;=65</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; w  0.25     0.2      0.05    0.5      0.0      0.0    </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; w0 0.25     0.2      0.05    0.5      0.0      0.0    </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; maximum :</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; 2.8813e-08 </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; convergence :</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; TRUE </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; itmax :</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; 1.0 </span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; deriv.ans :</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; 0.0, 3.6017e-08, 4.8528e-07, -1.1525e-07, -1.0310e-07, -7.9507e-08 </span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; gmax :</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; 0.0 </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; reason :</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; &quot;gmax &lt;= 0&quot; </span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>The output contains several key components:</p>
<ul>
<li><p><span class="math inline">\(w\)</span>: the converged D-optimal
approximate</p></li>
<li><p><span class="math inline">\(w_0\)</span>: random initial weights
used for the optimization</p></li>
<li><p><em>maximum</em>: the achieved maximum determinant of the Fisher
information matrix</p></li>
<li><p><em>reason</em>: criteria for lift-one loop termination with
either “all derivative &lt;=0”, and “gmax &lt;=0” (see
reference).</p></li>
</ul>
<p>To find the exact allocation (integer value of allocation), we can
use the <em>approxtoexact_constrained_func( )</em> with input of sample
size <span class="math inline">\(n\)</span>, approximate allocation
found by constrained lift-one algorithm, number of design point <span class="math inline">\(m\)</span>, coefficients <em>beta</em>, link type
of GLM (“logit” in this example),
<strong>Fdet_func=Fdet_func_GLM</strong>, and design matrix <span class="math inline">\(X\)</span>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>exact_design <span class="ot">=</span> CDsampling<span class="sc">::</span><span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">w=</span>approximate_design<span class="sc">$</span>w, <span class="at">m=</span><span class="dv">6</span>, </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                                                           <span class="at">beta=</span>beta, <span class="at">link=</span><span class="st">&#39;logit&#39;</span>, <span class="at">X=</span>X, </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                                                           <span class="at">Fdet_func=</span>Fdet_func_GLM, </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                                                          <span class="at">iset_func=</span>iset_func_trial, <span class="at">label=</span>label) </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">print</span>(exact_design)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; Optimal Sampling Results:</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; Optimal exact allocation:</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;                 F, 18-25 F, 26-64 F, &gt;=65 M, 18-25 M, 26-64 M, &gt;=65</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; allocation      50.0     40.0     10.0    100.0    0.0      0.0    </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; allocation.real 0.25     0.2      0.05    0.5      0.0      0.0    </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; det.maximum :</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; 46.1012 </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>The <em>allocation</em> represents the final D-optimal exact
allocation of the constrained sampling, while allocation.real is the
approximate allocation found in the previous step.</p>
<div class="note-box">
<p><strong>Note:</strong> When prior estimates of beta coefficients are
unavailable, consider using <strong>EW D-optimal allocations</strong> as
an alternative option. EW D-optimal method requires prior distributions
of beta coefficients, which substitutes the coefficients value with
expectation of prior distributions in the computaion. (Please see
reference for details).</p>
</div>
<p>If there is no knowledge of beta coefficients, we recommend using
constrained uniform design with <em>approxtoexact_constrained_func(
)</em>. We adjust <strong>Fdet_func =Fdet_func_unif</strong> and the
approximate application <span class="math inline">\(w\)</span> to be
<span class="math inline">\(1\)</span> subject in each subgroup. In this
example, we have <span class="math inline">\(n=200\)</span> sample thus
<span class="math inline">\(w=(1/200, 1/200, 1/200, 1/200, 1/200,
1/200)\)</span>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>w00 <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="dv">6</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>unif_design <span class="ot">=</span> CDsampling<span class="sc">::</span><span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">w=</span>w00, <span class="at">m=</span><span class="dv">6</span>, <span class="at">beta=</span><span class="cn">NULL</span>, </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">link=</span><span class="cn">NULL</span>, <span class="at">X=</span><span class="cn">NULL</span>, <span class="at">Fdet_func=</span>Fdet_func_unif, <span class="at">iset_func=</span>iset_func_trial)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">print</span>(unif_design)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; Optimal Sampling Results:</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; Optimal exact allocation:</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;                 1     2     3     4     5     6    </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; allocation      38.0  38.0  10.0  38.0  38.0  38.0 </span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; allocation.real 0.005 0.005 0.005 0.005 0.005 0.005</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; det.maximum :</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; 792351680.0 </span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>The <em>allocation</em> represents the constrained uniform exact
allocation, while allocation.real is the initial allocation we
provided.</p>
<p><a id="example4_trauma_data"></a></p>
</div>
<div id="example-4-trauma_data-constrained-sampling-with-mlm" class="section level2">
<h2>Example 4: trauma_data &amp; constrained sampling with MLM</h2>
<p>The <em>trauma_data</em> contains information on <span class="math inline">\(N=802\)</span> trauma patients with five ordered
treatment outcomes:</p>
<p>1). Death (<span class="math inline">\(1\)</span>)</p>
<p>2). Vegetative state (<span class="math inline">\(2\)</span>)</p>
<p>3). Major disability (<span class="math inline">\(3\)</span>)</p>
<p>4). Minor disability (<span class="math inline">\(4\)</span>)</p>
<p>5). Good recovery (<span class="math inline">\(5\)</span>).</p>
<p>We consider two key covariates:</p>
<p>1). <strong>Treatment dose levels</strong>:</p>
<ul>
<li><p><span class="math inline">\(x_{i1} = 1\)</span>: Placebo</p></li>
<li><p><span class="math inline">\(x_{i1} = 2\)</span>: Low
dose</p></li>
<li><p><span class="math inline">\(x_{i1} = 3\)</span>: Medium
dose</p></li>
<li><p><span class="math inline">\(x_{i1} = 4\)</span>: High
dose.</p></li>
</ul>
<p>2). <strong>Trauma symptoms</strong>:</p>
<ul>
<li><p><span class="math inline">\(x_{i2} = 0\)</span>: mild symptoms
(<span class="math inline">\(392\)</span> mild symptoms
patients)</p></li>
<li><p><span class="math inline">\(x_{i2} = 1\)</span>: moderate /severe
symptoms (<span class="math inline">\(410\)</span> moderate/severe
symptoms patients),</p></li>
</ul>
<p>This creates <span class="math inline">\(m=8\)</span> design points
from the combination of all covariates levels.</p>
<p>In this study, we plan to enroll <span class="math inline">\(n=600\)</span> patients and the constraint comes
from the available patients in the two trauma symptoms subgroups (<span class="math inline">\(392\)</span> and <span class="math inline">\(410\)</span>). The collection of all feasible
approximate allocation is: <span class="math display">\[S=\{(w_1,
\ldots, w_8)^\top \in S_0\mid n(w_1+w_2+w_3+w_4) \leq 392,
n(w_5+w_6+w_7+w_8) \leq 410\}.\]</span> This condition ensures that the
number of mild patients sampled from all the four dose levels does not
exceed the available mild patients, and the same applies to the
moderate/severe patients.</p>
<p>The cumulative non-proportional logit model is specified as:<span class="math display">\[\log(\frac{\pi_{i1}}{\pi_{i2}+\dots+\pi_{i5}}) =
\beta_{11}+\beta_{12}x_{i1}+\beta_{13}x_{i2}\]</span> <span class="math display">\[\log(\frac{\pi_{i1}+\pi_{i2}}{\pi_{i3}+\pi_{i4}+\pi_{i5}})
= \beta_{21}+\beta_{22}x_{i1}+\beta_{23}x_{i2}\]</span> <span class="math display">\[\log(\frac{\pi_{i1}+\pi_{i2}+\pi_{i3}}{\pi_{i4}+\pi_{i5}})
= \beta_{31}+\beta_{32}x_{i1}+\beta_{33}x_{i2}\]</span> <span class="math display">\[\log(\frac{\pi_{i1}+\dots+\pi_{i4}}{\pi_{i5}}) =
\beta_{41}+\beta_{42}x_{i1}+\beta_{43}x_{i2}\]</span></p>
<p>with the assumed parameter vector <span class="math inline">\(\boldsymbol\beta = (\hat\beta_{11},
\hat\beta_{12}, \hat\beta_{13}, \hat\beta_{21}, \hat\beta_{22},
\hat\beta_{23}, \hat\beta_{31}, \hat\beta_{32}, \hat\beta_{33},
\hat\beta_{41}, \hat\beta_{42}, \hat\beta_{43})^\top = (-4.047, -0.131,
4.214, -2.225, -0.376,\\ 3.519, -0.302, -0.237, 2.420, 1.386, -0.120,
1.284)^\top\)</span>.</p>
<p>For this example, we can reuse the set-up of design matrix and beta
coefficients from <a href="#example2_MLM_Fisher">Example 2: MLM Fisher
information matrix</a>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>J<span class="ot">=</span><span class="dv">5</span>; p<span class="ot">=</span><span class="dv">12</span>; m<span class="ot">=</span><span class="dv">8</span>; <span class="co">#response levels; num of parameters; num of design points</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.047</span>, <span class="sc">-</span><span class="fl">0.131</span>, <span class="fl">4.214</span>, <span class="sc">-</span><span class="fl">2.225</span>, <span class="sc">-</span><span class="fl">0.376</span>, <span class="fl">3.519</span>, <span class="sc">-</span><span class="fl">0.302</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.237</span>,  <span class="fl">2.420</span>, <span class="fl">1.386</span>,  <span class="sc">-</span><span class="fl">0.120</span>,  <span class="fl">1.284</span>) <span class="co">#coefficients</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>Xi<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,J<span class="sc">*</span>p<span class="sc">*</span>m) <span class="co">#design matrix</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">dim</span>(Xi)<span class="ot">=</span><span class="fu">c</span>(J,p,m)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>Xi[,,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>Xi[,,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>Xi[,,<span class="dv">3</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>),</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a> Xi[,,<span class="dv">4</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>),</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a> Xi[,,<span class="dv">5</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a> Xi[,,<span class="dv">6</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a> Xi[,,<span class="dv">7</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a> Xi[,,<span class="dv">8</span>] <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a>                <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>Similarly, we define the sample size (<span class="math inline">\(600\)</span>), constraints, and boundaries using
the following R codes:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>nsample<span class="ot">=</span><span class="dv">600</span> <span class="co">#sample size</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>constraint <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">392</span>, <span class="dv">410</span>)  <span class="co">#mild:severe</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#boundaries r_i1 and r_i2 in constrained lift-one</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>lower.bound <span class="ot">&lt;-</span> <span class="cf">function</span>(i, w0){</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">600</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  constraint <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">392</span>,<span class="dv">410</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">&lt;=</span> <span class="dv">4</span>){</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    a.lower <span class="ot">&lt;-</span> (<span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>])<span class="sc">-</span>(constraint[<span class="dv">2</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>]))</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  }</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>    a.lower <span class="ot">&lt;-</span> (<span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])<span class="sc">-</span>(constraint[<span class="dv">1</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  }</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  a.lower</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>}</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>upper.bound <span class="ot">&lt;-</span> <span class="cf">function</span>(i, w0){</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">600</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  constraint <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">392</span>,<span class="dv">410</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">&lt;=</span> <span class="dv">4</span>){</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>    b.upper <span class="ot">&lt;-</span> ((constraint[<span class="dv">1</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]) <span class="sc">-</span> (<span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])<span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(w0[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  }</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>    b.upper <span class="ot">&lt;-</span> ((constraint[<span class="dv">2</span>]<span class="sc">/</span>n)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>w0[i]) <span class="sc">-</span> (<span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>])<span class="sc">-</span>w0[i]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(w0[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>]))</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  }</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>  b.upper</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>}</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#constraints of the example</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>g.con <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">length</span>(constraint)<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>m, <span class="at">ncol=</span>m)</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>g.con[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,] <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ncol =</span> m, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>g.con[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, m)</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>g.con[<span class="dv">4</span><span class="sc">:</span>(<span class="fu">length</span>(constraint)<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>m), ] <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="at">nrow=</span>m)</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>g.dir <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;==&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>,<span class="st">&quot;&lt;=&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&gt;=&quot;</span>,m))</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>g.rhs <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">ifelse</span>((constraint<span class="sc">/</span>nsample<span class="sc">&lt;</span><span class="dv">1</span>),constraint<span class="sc">/</span>nsample,<span class="dv">1</span>), <span class="fu">rep</span>(<span class="dv">0</span>, m))</span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>Define an optional subgroups label for the constrained approximate
allocations:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>label <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Placebo-Mild&quot;</span>, <span class="st">&quot;Low-Mild&quot;</span>, <span class="st">&quot;Medium-Mild&quot;</span>, <span class="st">&quot;High-Mild&quot;</span>, <span class="st">&quot;Placebo-Severe&quot;</span>, <span class="st">&quot;Low-Severe&quot;</span>, <span class="st">&quot;Medium-Severe&quot;</span>, <span class="st">&quot;High-Severe&quot;</span>)</span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>Then, we can use the constrained lift-one algorithm to find the
locally D-optimal approximate sampling with <em>liftone_constrained_MLM(
)</em> function in the package:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>approx_design <span class="ot">=</span> CDsampling<span class="sc">::</span><span class="fu">liftone_constrained_MLM</span>(<span class="at">m=</span>m, <span class="at">p=</span>p, <span class="at">Xi=</span>Xi, <span class="at">J=</span>J, <span class="at">beta=</span>beta, </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                                       <span class="at">lower.bound=</span>lower.bound, <span class="at">upper.bound=</span>upper.bound, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                                        <span class="at">g.con=</span>g.con, <span class="at">g.dir=</span>g.dir, <span class="at">g.rhs=</span>g.rhs, <span class="at">label=</span>label, <span class="at">w00=</span><span class="cn">NULL</span>, </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                                        <span class="at">link=</span><span class="st">&#39;cumulative&#39;</span>, <span class="at">Fi.func =</span> Fi_func_MLM, </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                                        <span class="at">reltol=</span><span class="fl">1e-5</span>, <span class="at">maxit=</span><span class="dv">500</span>, <span class="at">delta =</span> <span class="fl">1e-6</span>, </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                                        <span class="at">epsilon=</span><span class="fl">1e-8</span>, <span class="at">random=</span><span class="cn">TRUE</span>, <span class="at">nram=</span><span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="fu">print</span>(approx_design)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; Optimal Sampling Results:</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; Optimal approximate allocation:</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;    Placebo-Mild Low-Mild Medium-Mild High-Mild Placebo-Severe Low-Severe</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; w  0.2594       0.0      0.0         0.1666    0.2796         0.0       </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; w0 0.0          0.0      0.3167      0.0       0.6833         0.0       </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;    Medium-Severe High-Severe</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; w  0.0           0.2944     </span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; w0 0.0           0.0        </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; Maximum :</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; 7.4958e-11 </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; itmax :</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; 12.0 </span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; convergence :</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; TRUE </span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; deriv.ans :</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; -7.5290e-11, -4.0225e-11, -4.0225e-11, -3.7980e-10, 1.0340e-25, -4.0225e-11, -4.0225e-11, 5.2256e-11 </span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; gmax :</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; NA </span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt; reason :</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt; &quot;all derivative &lt;=0&quot; </span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>Similar to <a href="#example3_trial_data">Example 3: trial_data &amp;
constrained sampling with GLM</a>, <span class="math inline">\(w\)</span> reports the D-optimal approximate
allocation, while <span class="math inline">\(w_0\)</span> denotes the
random initial weights used in the optimization procedure.
<em>maximum</em> reports the determinant of Fisher information matrix,
and <em>reason</em> is the termination criteria for the lift-one
algorithm.</p>
<p>To convert the approximate allocation to exact allocation, we use the
function <em>approxtoexact_constrained_func( )</em> in the package, with
<strong>Fdet_func=Fdet_func_MLM</strong>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>exact_design <span class="ot">=</span> CDsampling<span class="sc">::</span><span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">600</span>, <span class="at">w=</span>approx_design<span class="sc">$</span>w, <span class="at">m=</span><span class="dv">8</span>, </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a> <span class="at">beta=</span>beta, <span class="at">link=</span><span class="st">&#39;cumulative&#39;</span>, <span class="at">X=</span>Xi, <span class="at">Fdet_func=</span>Fdet_func_MLM, </span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a> <span class="at">iset_func=</span>iset_func_trauma, <span class="at">label=</span>label)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">print</span>(exact_design)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Optimal Sampling Results:</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Optimal exact allocation:</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt;                 Placebo-Mild Low-Mild Medium-Mild High-Mild Placebo-Severe</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; allocation      155.0        0.0      0.0         100.0     168.0         </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; allocation.real 0.2594       0.0      0.0         0.1666    0.2796        </span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;                 Low-Severe Medium-Severe High-Severe</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; allocation      0.0        0.0           177.0      </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; allocation.real 0.0        0.0           0.2944     </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; det.maximum :</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; 1.63163827059162e+23 </span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<p>If there is no coefficients information, we can find the constrained
uniform sampling with <em>approxtoexact_constrained_func( )</em> using
<strong>Fdet_func=Fdet_func_unif</strong>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>iset_func_trauma <span class="ot">&lt;-</span> <span class="cf">function</span>(allocation){</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  iset <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">8</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(allocation[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])<span class="sc">&gt;=</span><span class="dv">392</span>){iset[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]<span class="ot">=</span><span class="dv">0</span>}</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(allocation[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>])<span class="sc">&gt;=</span><span class="dv">410</span>){iset[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>]<span class="ot">=</span><span class="dv">0</span>}</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="fu">return</span>(iset)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a> }</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>unif_design <span class="ot">=</span> CDsampling<span class="sc">::</span><span class="fu">approxtoexact_constrained_func</span>(<span class="at">n=</span><span class="dv">600</span>, <span class="at">w=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">600</span>,<span class="dv">8</span>), <span class="at">m=</span><span class="dv">8</span>, <span class="at">beta=</span><span class="cn">NULL</span>, </span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a> <span class="at">link=</span><span class="cn">NULL</span>, <span class="at">X=</span><span class="cn">NULL</span>, <span class="at">label=</span>label, <span class="at">Fdet_func=</span>Fdet_func_unif, <span class="at">iset_func=</span>iset_func_trauma)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>unif_design</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; Optimal Sampling Results:</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; Optimal exact allocation:</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt;                 Placebo-Mild Low-Mild Medium-Mild High-Mild Placebo-Severe</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; allocation      75.0         75.0     75.0        75.0      75.0          </span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; allocation.real 0.0017       0.0017   0.0017      0.0017    0.0017        </span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;                 Low-Severe Medium-Severe High-Severe</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt; allocation      75.0       75.0          75.0       </span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; allocation.real 0.0017     0.0017        0.0017     </span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt; det.maximum :</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; 1001129150390625 </span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------------------</span></span></code></pre></div>
<p>/private/var/folders/vf/_6q3gfkd14v15hhpcwlkrnc00000gn/T/RtmpGXCeEi/Rbuild99117cbf53a7/CDsampling/vignettes/Intro_to_CDsampling.R</p>
<div class="note-box">
<p><strong>Note:</strong><br />
The reported determinant of the Fisher information matrix
(<code>det.maximum</code>) is <em>model-specific</em> and depends on the
choice of <code>Fdet_func</code>. For meaningful comparisons:<br />
- Use <code>Fdet_func_GLM( )</code> for GLMs with the derived
allocations<br />
- Use <code>Fdet_func_MLM( )</code> for MLMs with the derived
allocations</p>
<p><strong>Do not compare</strong> values across functions.</p>
</div>
<p><a id="References"></a></p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li>Huang Y., Tong L., Yang J. (2025). <em>Constrained D-optimal Design
for Paid Research Study</em>, Statistica Sinica, DOI:
10.5705/ss.202022.0414.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
